<app-header></app-header>
<app-modal #modal [title]="title"
[rejectButtonText]="'general.cancel'| translate"
>
    <div [innerHTML]="bodyModal"></div>
</app-modal>
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-3">
        </div>
        <div class="col-lg-6 p-4 col-12">
            <div class="card container-box">
                <app-floating-alert [alertMessage]="alertMessage" [backendMessage]="backendMessage"/>
                <h5 class="card-header bg-primary text-light">Profile</h5>
                <div class="card-body">
                    <form [formGroup]="basicInfoForm" (ngSubmit)="onSubmit()" autocomplete="off">
                        <div class="fade-in">
                            <div class="row mb-3">
                                <div class="col-12 col-lg-6">
                                    <label for="firstName" class="form-label fw-bold">{{'profile.firstName' |
                                        translate}}</label>
                                    <input type="text" class="form-control" placeholder="" id="firstName"
                                        formControlName="firstname" value="{{user.firstname}}" appCapitalizeFirst
                                        noWhitespace 
                                        [ngClass]="{'is-invalid': basicInfoForm.get('firstName')?.invalid && (basicInfoForm.get('firstName')?.dirty || basicInfoForm.get('firstName')?.touched)}"     
                                        />
                                    @if(basicInfoForm.get('firstname')?.invalid &&
                                    (basicInfoForm.get('firstname')?.dirty || basicInfoForm.get('firstname')?.touched
                                    )){
                                    <div>
                                        @if(basicInfoForm.get('firstname')?.errors?.['required']){
                                        <small class="form-text text-danger">
                                            {{'auth.isFirstNameRequired' | translate}}
                                        </small>
                                        }
                                    </div>
                                    }
                                </div>
                                <div class="col-12 col-lg-6">
                                    <label for="lastName" class="form-label fw-bold">{{'profile.lastName' |
                                        translate}}</label>
                                    <input type="text" class="form-control" placeholder="" id="lastName"
                                        formControlName="lastname" appCapitalizeFirst 
                                        noWhitespace 
                                        [ngClass]="{'is-invalid': basicInfoForm.get('lastname')?.invalid && (basicInfoForm.get('lastname')?.dirty || basicInfoForm.get('lastname')?.touched)}"     
                                        />
                                    @if(basicInfoForm.get('lastname')?.invalid && (basicInfoForm.get('lastname')?.dirty
                                    || basicInfoForm.get('lastname')?.touched )){
                                    <div>
                                        @if(basicInfoForm.get('lastname')?.errors?.['required']){
                                        <small class="form-text text-danger">
                                            {{'auth.isLastNameRequired' | translate}}
                                        </small>
                                        }
                                    </div>
                                    }
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="mb-3">
                                    <label for="phone" class="form-label fw-bold">{{'profile.phone' |
                                        translate}}</label>
                                    <input type="tel" class="form-control" id="phone" formControlName="phone"
                                        placeholder="(123) 4567890" mask="(000) 000-0000"
                                        noWhitespace 
                                        [ngClass]="{'is-invalid': basicInfoForm.get('phone')?.invalid && (basicInfoForm.get('phone')?.dirty || basicInfoForm.get('phone')?.touched)}"     
                                        />
                                    @if(basicInfoForm.get('phone')?.invalid &&
                                    (basicInfoForm.get('phone')?.dirty || basicInfoForm.get('phone')?.touched
                                    )){
                                    <div>
                                        @if(basicInfoForm.get('phone')?.errors?.['required']){
                                        <small class="form-text text-danger">
                                            {{'auth.isPhoneRequired' | translate}}
                                        </small>
                                        }
                                        @else if(basicInfoForm.get('phone')?.errors?.['pattern']){
                                        <small class="form-text text-danger">
                                            {{'auth.isPhoneMaximum10' | translate}}
                                        </small>
                                        }
                                    </div>
                                    }
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="mb-3">
                                    <label for="email" class="form-label fw-bold">{{'profile.email' |
                                        translate}}</label>
                                    <input type="email" class="form-control" id="email" formControlName="email" 
                                    noWhitespace 
                                    [ngClass]="{'is-invalid': basicInfoForm.get('email')?.invalid && (basicInfoForm.get('email')?.dirty || basicInfoForm.get('email')?.touched)}" 
                                    />
                                    @if(basicInfoForm.get('email')?.invalid &&
                                    (basicInfoForm.get('email')?.dirty || basicInfoForm.get('email')?.touched
                                    )){
                                    <div>
                                        @if(basicInfoForm.get('email')?.errors?.['required']){
                                        <small class="form-text text-danger">
                                            {{'auth.isEmailRequired' | translate}}
                                        </small>
                                        }
                                    </div>
                                    }
                                </div>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="allowNotifications"  [formControl]="allowNotificationsControl">
                                <label class="form-check-label" for="allowNotifications">
                                    Allow notifications
                                </label>
                              </div>
                            <div class="d-flex justify-content-end mt-3">
                                <button type="submit" class="btn btn-primary mt-3">{{'general.save'|translate}}</button>
                            </div>
                        </div>
                    </form>

                    @if(isLoading){
                    <div class="d-flex justify-content-center mt-3">
                        <div class="spinner-border" role="status">
                        </div>
                    </div>
                    }
                   
                </div>
            </div>
        </div>
        <div class="col-lg-3">
        </div>
    </div>
</div>